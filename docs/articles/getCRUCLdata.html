<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>getCRUCLdata • getCRUCLdata</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">getCRUCLdata</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adamhsparks/getCRUCLdata">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>getCRUCLdata</h1>
                        <h4 class="author">Adam H. Sparks</h4>
            
            <h4 class="date">2017-02-23</h4>
          </div>

    
    
<div class="contents">
<div id="introduction-to-getcrucldata" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#introduction-to-getcrucldata" class="anchor"> </a></body></html>Introduction to getCRUCLdata</h1>
<p>The getCRUCLdata package provides two functions that automate downloading and importing CRU CL2.0 climatology data into R, facilitate the calculation of minimum temperature and maximum temperature, and formats the data into a tidy data frame or a list of raster stack objects for use in an R session. CRU CL2.0 data are a gridded climatology of 1961-1990 monthly means released in 2002 and cover all land areas (excluding Antarctica) at 10 arcminutes (0.1666667 degree) resolution. For more information see the description of the data provided by the University of East Anglia Climate Research Unit (CRU), <a href="https://crudata.uea.ac.uk/cru/data/hrg/tmc/readme.txt" class="uri">https://crudata.uea.ac.uk/cru/data/hrg/tmc/readme.txt</a>.</p>
</div>
<div id="using-getcrucldata" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#using-getcrucldata" class="anchor"> </a></body></html>Using getCRUCLdata</h1>
<p>Both functions, <code>create_CRU_df</code> and <code>create_CRU_stack</code> take the same arguments but return different types of objects in the R session. Logical arguments are used to specify the data to retrieve and parse. The arguments for selecting the climatology elements for download are:</p>
<ul>
<li>
<strong>pre</strong> Logical. Fetch precipitation (milimetres/month) from server and return in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>pre_cv</strong> Logical. Fetch cv of precipitation (percent) from server and return in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>rd0</strong> Logical. Fetch wet-days (number days with &gt;0.1milimetres rain per month) and return in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>dtr</strong> Logical. Fetch mean diurnal temperature range (degrees Celsius) and return it in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>tmp</strong> Logical. Fetch temperature (degrees Celsius) and return it in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>tmn</strong> Logical. Calculate minimum temperature values (degrees Celsius) and return it in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>tmx</strong> Logical. Calculate maximum temperature (degrees Celsius) and return it in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>reh</strong> Logical. Fetch relative humidity and return it in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>sunp</strong> Logical. Fetch sunshine, percent of maximum possible (percent of day length) and return it in data? Defaults to FALSE.<br>
</li>
<li>
<strong>frs</strong> Logical. Fetch ground-frost records (number of days with ground- frost per month) and return it in data? Defaults to FALSE.<br>
</li>
<li>
<strong>wnd</strong> Logical. Fetch 10m wind speed (metres/second) and return it in the data? Defaults to FALSE.<br>
</li>
<li>
<strong>elv</strong> Logical. Fetch elevation (and convert to metres from kilometres) and return it in the data? Defaults to FALSE.</li>
</ul>
<div id="creating-tidy-data-frames-for-use-in-r" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#creating-tidy-data-frames-for-use-in-r" class="anchor"> </a></body></html>Creating tidy data frames for use in R</h2>
<p>The <code><a href="../reference/create_CRU_df.html">create_CRU_df()</a></code> function creates tidy data frames of the CRU CL2.0 climatology elements. Illustrated here, create a tidy data frame of all CRU CL2.0 climatology elements available.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(getCRUCLdata)

CRU_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_CRU_df.html">create_CRU_df</a></span>(<span class="dt">pre =</span> <span class="ot">TRUE</span>,
                          <span class="dt">pre_cv =</span> <span class="ot">TRUE</span>,
                          <span class="dt">rd0 =</span> <span class="ot">TRUE</span>,
                          <span class="dt">tmp =</span> <span class="ot">TRUE</span>,
                          <span class="dt">dtr =</span> <span class="ot">TRUE</span>,
                          <span class="dt">reh =</span> <span class="ot">TRUE</span>,
                          <span class="dt">tmn =</span> <span class="ot">TRUE</span>,
                          <span class="dt">tmx =</span> <span class="ot">TRUE</span>,
                          <span class="dt">sunp =</span> <span class="ot">TRUE</span>,
                          <span class="dt">frs =</span> <span class="ot">TRUE</span>,
                          <span class="dt">wnd =</span> <span class="ot">TRUE</span>,
                          <span class="dt">elv =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Perhaps you only need one or two elements, it is easy to create a tidy data frame of mean temperature only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_CRU_df.html">create_CRU_df</a></span>(<span class="dt">tmp =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Save the resulting tidy data frame to local disk as a comma separated (CSV) file to local disk.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)

<span class="kw">write_csv</span>(t, <span class="dt">path =</span> <span class="st">"~/"</span>)</code></pre></div>
</div>
<div id="plotting-data-from-the-tidy-dataframe" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#plotting-data-from-the-tidy-dataframe" class="anchor"> </a></body></html>Plotting data from the tidy dataframe</h2>
<p>Now that we have the data, we can plot it easily using <a href="http://ggplot2.org"><code>ggplot2</code></a> and the fantastic <a href="https://cran.r-project.org/web/packages/viridis/"><code>viridis</code></a> package for the colour scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">"ggplot2"</span>)) {
  <span class="kw">install.packages</span>(ggplot2)
}
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">"viridis"</span>)) {
  <span class="kw">install.packages</span>(<span class="st">"viridis"</span>)
}

<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(viridis)</code></pre></div>
<p>Now that the required packages are installed and loaded, we can generate a figure of temperature ranges using <code>ggplot2</code> to map the 12 months.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> t, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> tmp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">option =</span> <span class="st">"inferno"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_quickmap</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Global Mean Monthly Temperature 1961-1990"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>month, <span class="dt">nrow =</span> <span class="dv">4</span>)</code></pre></div>
<div class="figure">
<img src="README-unnamed-chunk-6-1.png" alt="Plot of global mean monthly temperatures 1961-1990"><p class="caption">Plot of global mean monthly temperatures 1961-1990</p>
</div>
<p>We can generate a violin plot of the same data to look at global relative humidity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> t, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> tmp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Global Monthly Mean Land Surface Temperatures From 1960-1991"</span>)</code></pre></div>
<div class="figure">
<img src="README-unnamed-chunk-7-1.png" alt="Violin plot of global mean temperatures 1961-1990"><p class="caption">Violin plot of global mean temperatures 1961-1990</p>
</div>
</div>
<div id="creating-raster-stacks-for-use-in-r-or-saving-for-use-in-a-gis" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#creating-raster-stacks-for-use-in-r-or-saving-for-use-in-a-gis" class="anchor"> </a></body></html>Creating raster stacks for use in R or saving for use in a GIS</h2>
<p>The <code><a href="../reference/create_CRU_stack.html">create_CRU_stack()</a></code> function provides functionality for producing a list of <a href="https://CRAN.R-project.org/package=raster">raster</a> stack objects for use in an R session.</p>
<p>Create a list of raster stacks of all CRU CL2.0 climatology elements available.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CRU_stack &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_CRU_stack.html">create_CRU_stack</a></span>(<span class="dt">pre =</span> <span class="ot">TRUE</span>,
                              <span class="dt">pre_cv =</span> <span class="ot">TRUE</span>,
                              <span class="dt">rd0 =</span> <span class="ot">TRUE</span>,
                              <span class="dt">tmp =</span> <span class="ot">TRUE</span>,
                              <span class="dt">dtr =</span> <span class="ot">TRUE</span>,
                              <span class="dt">reh =</span> <span class="ot">TRUE</span>,
                              <span class="dt">tmn =</span> <span class="ot">TRUE</span>,
                              <span class="dt">tmx =</span> <span class="ot">TRUE</span>,
                              <span class="dt">sunp =</span> <span class="ot">TRUE</span>,
                              <span class="dt">frs =</span> <span class="ot">TRUE</span>,
                              <span class="dt">wnd =</span> <span class="ot">TRUE</span>,
                              <span class="dt">elv =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Create a list of raster stacks of maximum and minimum temperature.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmn_tmx &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_CRU_stack.html">create_CRU_stack</a></span>(<span class="dt">tmn =</span> <span class="ot">TRUE</span>,
                            <span class="dt">tmx =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Plot raster stacks of tmin and tmax</p>
<p>Because the stacks are in a list, we need to access each element of the list individually to plot them, that’s what the <code>[[1]]</code> or <code>[[2]]</code> is, the first or second element of the list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)

<span class="kw">plot</span>(tmn_tmx[[<span class="dv">1</span>]])</code></pre></div>
<div class="figure">
<img src="README-unnamed-chunk-10-1.png" alt="Plot of raster layers from minimum temperature stack"><p class="caption">Plot of raster layers from minimum temperature stack</p>
</div>
<p>To plot only one month from the stack is also possible. Here we plot maxmimum temperature for July. Note that we use indexing <code>[[2]]</code> as before but append a <code>$jul</code> to the object. This is the name of the layer in the raster stack. So, we are telling R to plot the second object in the <code>tmn_tmx</code> list, which is <code>tmx</code> and from that raster stack, plot only the layer for July.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(tmn_tmx[[<span class="dv">2</span>]]<span class="op">$</span>jul)</code></pre></div>
<div class="figure">
<img src="README-unnamed-chunk-11-1.png" alt="Plot of maximum temperatures for July"><p class="caption">Plot of maximum temperatures for July</p>
</div>
<p>Saving raster format files to a local disk as geotiff files in the <code>tmp</code> directory with a tmn or tmx prefix to the month for a filename.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)

<span class="kw">dir.create</span>(<span class="kw">file.path</span>(<span class="st">"~/tmp"</span>), <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)
<span class="kw">writeRaster</span>(tmn_tmx<span class="op">$</span>tmn, <span class="dt">filename =</span> <span class="kw">paste0</span>(<span class="st">"~/tmp/tmn_"</span>, <span class="kw">names</span>(tmn_tmx<span class="op">$</span>tmn)), <span class="dt">bylayer =</span> <span class="ot">TRUE</span>, <span class="dt">format =</span> <span class="st">"GTiff"</span>)

<span class="kw">writeRaster</span>(tmn_tmx<span class="op">$</span>tmx, <span class="dt">filename =</span> <span class="kw">paste0</span>(<span class="st">"~/tmp/tmx_"</span>, <span class="kw">names</span>(tmn_tmx<span class="op">$</span>tmn)), <span class="dt">bylayer =</span> <span class="ot">TRUE</span>, <span class="dt">format =</span> <span class="st">"GTiff"</span>)</code></pre></div>
</div>
</div>
<div id="cru-cl2-0-reference-and-abstract" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#cru-cl2-0-reference-and-abstract" class="anchor"> </a></body></html>CRU CL2.0 reference and abstract</h1>
<blockquote>
<p>Mark New (1,*), David Lister (2), Mike Hulme (3), Ian Makin (4)<br>
A high-resolution data set of surface climate over global land areas Climate Research, 2000, Vol 21, pg 1-25<br>
(1) School of Geography and the Environment, University of Oxford, Mansfield Road, Oxford OX1 3TB, United Kingdom<br>
(2) Climatic Research Unit, and (3) Tyndall Centre for Climate Change Research, both at School of Environmental Sciences, University of East Anglia, Norwich NR4 7TJ, United Kingdom<br>
(4) International Water Management Institute, PO Box 2075, Colombo, Sri Lanka</p>
</blockquote>
<blockquote>
<p><strong>ABSTRACT:</strong> We describe the construction of a 10-minute latitude/longitude data set of mean monthly surface climate over global land areas, excluding Antarctica. The climatology includes 8 climate elements - precipitation, wet-day frequency, temperature, diurnal temperature range, relative humidity,sunshine duration, ground frost frequency and windspeed - and was interpolated from a data set of station means for the period centred on 1961 to 1990. Precipitation was first defined in terms of the parameters of the Gamma distribution, enabling the calculation of monthly precipitation at any given return period. The data are compared to an earlier data set at 0.5 degrees latitude/longitude resolution and show added value over most regions. The data will have many applications in applied climatology, biogeochemical modelling, hydrology and agricultural meteorology and are available through the School of Geography Oxford (<a href="http://www.geog.ox.ac.uk" class="uri">http://www.geog.ox.ac.uk</a>), the International Water Management Institute “World Water and Climate Atlas” (<a href="http://www.iwmi.org" class="uri">http://www.iwmi.org</a>) and the Climatic Research Unit (<a href="http://www.cru.uea.ac.uk" class="uri">http://www.cru.uea.ac.uk</a>).</p>
</blockquote>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-to-getcrucldata">Introduction to getCRUCLdata</a></li>
      <li>
<a href="#using-getcrucldata">Using getCRUCLdata</a><ul class="nav nav-pills nav-stacked">
<li><a href="#creating-tidy-data-frames-for-use-in-r">Creating tidy data frames for use in R</a></li>
      <li><a href="#plotting-data-from-the-tidy-dataframe">Plotting data from the tidy dataframe</a></li>
      <li><a href="#creating-raster-stacks-for-use-in-r-or-saving-for-use-in-a-gis">Creating raster stacks for use in R or saving for use in a GIS</a></li>
      </ul>
</li>
      <li><a href="#cru-cl2.0-reference-and-abstract">CRU CL2.0 reference and abstract</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Adam Sparks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
